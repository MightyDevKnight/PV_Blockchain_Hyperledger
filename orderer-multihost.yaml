# 
# Copyright . All Rights Reserved.
#

version: '3.7'

services:

  orderer:
    volumes:
      - ${WORK_DIR:-/home/docker}/crypto-config/configtx:/etc/hyperledger/configtx
      - ${WORK_DIR:-/home/docker}/crypto-config/ordererOrganizations/${DOMAIN:-example.com}/orderers/orderer.${DOMAIN:-example.com}/:/etc/hyperledger/crypto/orderer
    ports:
      - ${ORDERER_PORT:-7050}:7050

  cli.orderer:
    volumes:
      - ${WORK_DIR:-/home/docker}/crypto-config:/etc/hyperledger/crypto-config
      - ${WORK_DIR:-/home/docker}/templates:/etc/hyperledger/templates
      - ${WORK_DIR:-/home/docker}/crypto-config/ordererOrganizations/${DOMAIN:-example.com}/orderers/orderer.${DOMAIN:-example.com}:/etc/hyperledger/crypto/orderer
      - ${WORK_DIR:-/home/docker}/crypto-config/ordererOrganizations/${DOMAIN:-example.com}/users/Admin@${DOMAIN:-example.com}:/etc/hyperledger/crypto/ordereradmin
    extra_hosts:
      - "peer0.org1.example.com:${ORG1_IP:-192.168.99.101}"
      - "www.org1.example.com:${ORG1_IP:-192.168.99.101}"
      - "peer0.org2.example.com:${ORG2_IP:-192.168.99.102}"
      - "www.org2.example.com:${ORG2_IP:-192.168.99.102}"
      - "peer0.org3.example.com:${ORG3_IP:-192.168.99.103}"
      - "www.org3.example.com:${ORG3_IP:-192.168.99.103}"

  # http serves certificates
  www.orderer:
    volumes:
      - ${WORK_DIR:-/home/docker}/crypto-config/ordererOrganizations/${DOMAIN:-example.com}/msp:/usr/share/nginx/html/msp
    ports:
      - ${WWW_PORT:-80}:80

#networks:
#  default:
#    name: fabric-overlay
#    driver: overlay